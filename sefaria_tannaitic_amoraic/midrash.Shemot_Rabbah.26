ויבא עמלק, הדא הוא דכתיב : לא שלותי ולא שקטתי ולא נחתי ויבא רגז. לא שלותי, מבבל. ולא שקטתי, ממדי. ולא נחתי, מיון. ויבא רגז, באדום. דבר אחר, לא שלותי, מגזרה הראשונה שגזר פרעה עלי, שנאמר : וימררו את חייהם, והעמיד לו הקדוש ברוך הוא גואל, זו מרים, על שם המרור. ולא שקטתי, מגזרה שניה : אם בן הוא והמתן אתו, והעמיד הקדוש ברוך הוא גואל, זה אהרן, על שם ההריון. ולא נחתי, מגזרה שלישית שגזר ואמר : כל הבן הילוד היארה תשליכהו, והעמיד הקדוש ברוך הוא גואל, על שם המים, זה משה, שנאמר : כי מן המים משיתהו, ויבא רגז, זה עמלק.
ויבא עמלק, מה כתיב למעלה מן הענין : ויסעו כל עדת בני ישראל, ואין מים לשתת העם, לעם לא היה, לצאן ולבקר היה, מיד באו לעשות מריבה עם משה ואמרו לו : למה זה העליתנו ממצרים, מכן היה רבי יהושע אומר נפל ביתא חבל לכותא. : אני ומקני בצמא, יש אומרים בהמתו של אדם אינה אלא חייו, יוצא אדם לדרך אם אין בהמתו עמו מסתגף הוא. מיד עמד משה בתפלה, שנאמר : ויצעק משה אל ה' לאמר, מהו לאמר, אמר לפניו רבונו של עולם הודיעני אם הורגים אותי אם לאו, אמר לו מה אכפת לך : עבר לפני העם, מהו עבר, אמר לו עבר על דבריהם. רבי מאיר אומר, מהו עבר, אמר הוי דומה לי, מה אני משלם טובה תחת רעה, אף אתה הוי משלם טובה תחת רעה, שנאמר : מי אל כמוך נשא עון ועבר על פשע. רבי יהודה אומר עבר על חטיא שלהם, ורבי נחמיה אומר: עבר לפני העם, מי שיש בו גאוה יבוא וידבר כנגדך. וקח אתך מזקני ישראל, שיהיו עדים שלא יהו אומרים לך מעינות היו שם. : ומטך אשר הכית בו את היאר, אמר לפניו רבונו של עולם מטה זה של פרענות הוא, הוא הבאיש המים במצרים והוא הביא עשר מכות על המצרים. אמר לו הקדוש ברוך הוא אין מדתי כמדת בשר ודם שהוא מכה באזמל ומרפא ברטיה, אבל אני במה שאני מכה בו אני מרפא, לכך נאמר: ומטך אשר הכית בו את היאר קח בידך, כדי שידעו הכל שהוא של ברכה. : והכית בצור, מהו והכית בצור, אמר לו הקדוש ברוך הוא, אם מבקשים הם מן האבן הזו הוציא להם, אם מן האבן הזו תן להם, כיון שיצאו המים השקו כל אהליהם של ישראל. מה כתיב שם : ויקרא שם המקום ההוא מסה ומריבה, ומה מריבה היתה שם, רבי יהודה ורבי נחמיה ורבנן, רבי יהודה אומר אמרו אם רבון הוא על כל המעשים כדרך שהוא רבון עלינו, נעבדנו, ואם לאו נמרד בו. ורבי נחמיה אומר אם מספיק לנו מזונותינו כמלך שהוא שרוי במדינה ואין בני המדינה צריכין לו כלום, נעבדנו, ואם לאו נמרד בו. ורבותינו אמרו אם מהרהרים אנו בלבבנו והוא יודע מה שאנו מהרהרים, נעבדנו, ואם לאו נמרד בו. אמר להם הקדוש ברוך הוא אם בקשתם לבדק אותי יבוא הרשע ויבדק אתכם, מיד ויבא עמלק, מה כתיב שם : היש ה' בקרבנו אם אין ויבא עמלק, וכי מה ענין זה אצל זה, משל לתינוק שהיה רוכב על כתפו של אביו וראה חברו של אביו, אמר לו, ראית את אבא, אמר לו אביו אתה רוכב על כתפי ואתה שואל עלי, הריני משליכך ויבוא השונא וישלט בך. כך אמר הקדוש ברוך הוא לישראל, אני נשאתי אתכם על ענני כבוד ואתם אומרים: היש ה' בקרבנו, לפיכך יבוא השונא וישלט בכם, הוי: ויבא עמלק.
ויאמר משה אל יהושע בחר לנו אנשים, למה ליהושע, מתחלה אתה דורש שהיה מבקש להדריכו למלחמה, לפי שהוא עתיד להכניס את ישראל לארץ. דבר אחר, למה ליהושע, אמר לו זקנך על ידו ירדו למצרים, לך הזדוג עם מי שארע אותם בעלותם ממצרים. דבר אחר, למה ליהושע, אמר לו זקנך אמר : את האלקים אני ירא, ובזה כתיב : ולא ירא אלהים, יבוא בן בנו שאמר את האלהים אני ירא, ויפרע ממי שנאמר עליו ולא ירא אלהים. בחר לנו אנשים, מהו אנשים, אנשים של חכמה וביראת חטא. וצא הלחם בעמלק, מכן אתה למד שהיו תחת ענני הכבוד, שאין אומרים צא אלא למי שהוא שרוי בפנים. ומטה האלהים בידי, אמר לו מטה זה בידי, שאמר המקום יהי בידך לעולם. דבר אחר, ומטה האלהים בידי, כשעשה בו אהרן נסים, נקרא על שמו, שנאמר : מטה אהרן, ובזמן שעשיתי אני בו נסים, נקרא על שמי. ובזמן שהקדוש ברוך הוא עושה נסים, נקרא על שמו, שנאמר: ומטה האלהים.